import{a as I,b as y,c as G,d as k,f as O,h as $,i as V,j as L,k as D,q as M,r as B,s as R,t as z}from"./chunk-MCHYEH5B.js";import{A as w,L as _,M as v,N as g,O as p,P as n,Q as o,R as f,V as b,W as x,X as d,da as c,ea as h,fa as E,ia as A,l as S,m as u,n as C,o as F,p as T,ra as N,x as l}from"./chunk-JI3CS4DV.js";var q=(a,t)=>({"text-red-500":a,"text-blue-500":t});function P(a,t){if(a&1){let e=b();n(0,"li",10),x("click",function(){let i=u(e),s=i.$implicit,m=i.$index,j=d();return C(j.onCriterionSelect(s,m))}),f(1,"input",11),n(2,"span"),c(3),o()()}if(a&2){let e=t.$implicit;l(),p("checked",e.selected),l(2),h(e.name)}}function W(a,t){if(a&1){let e=b();n(0,"div",20),f(1,"input",25)(2,"input",26),n(3,"button",16),x("click",function(){let i=u(e).$index,s=d().$index,m=d();return C(m.removeOption(s,i))}),F(),n(4,"svg",17),f(5,"path",27),o()()()}if(a&2){let e=t.$index;p("formGroupName",e)}}function U(a,t){if(a&1){let e=b();n(0,"div",9)(1,"div",12)(2,"div",13)(3,"span",14),c(4),o(),n(5,"span",15),c(6),o()(),n(7,"button",16),x("click",function(){let i=u(e).$index,s=d();return C(s.removeCriterion(i))}),F(),n(8,"svg",17),f(9,"path",18),o()()(),T(),n(10,"div",19),v(11,W,6,1,"div",20,_),o(),n(13,"div",21)(14,"span",22),c(15,"TOTAL DISTRIBUTION"),o(),n(16,"span",23),c(17),o()(),n(18,"button",24),x("click",function(){let i=u(e).$index,s=d();return C(s.addOption(i))}),c(19),o()()}if(a&2){let e=t.$implicit,r=t.$index,i=d();p("formGroupName",r),l(4),h(r+1),l(2),h(e.value.name),l(5),g(i.getOptions(r).controls),l(5),p("ngClass",A(6,q,i.calculateTotal(e)!==100,i.calculateTotal(e)===100)),l(),E(" ",i.calculateTotal(e),"% "),l(2),E(" + Add ",e.value.name," ")}}var H=class a{fb=S(M);formService=S(z);form=this.formService.mainForm.get("distributionForm");allCriteria=[{name:"Age Group",selected:!1},{name:"Department",selected:!1},{name:"Gender",selected:!1},{name:"Location",selected:!1}];get selectedCriteria(){return this.form.get("selectedCriteria")}ngOnInit(){this.syncCriteriaSelectionWithForm()}syncCriteriaSelectionWithForm(){let t=this.selectedCriteria.value.map(e=>e.name);this.allCriteria.forEach(e=>{e.selected=t.includes(e.name)})}setCriterionOptions(t,e){let r=this.allCriteria.find(m=>m.name===t);if(!r)return;r.selected=!0;let i=this.createCriterion(t),s=i.get("options");e.forEach(m=>{s.push(this.createOption(m.name,m.percentage))}),this.selectedCriteria.push(i)}getOptions(t){return this.selectedCriteria.at(t).get("options")}createCriterion(t){return this.fb.group({name:[t],options:this.fb.array([],y.required)})}createOption(t,e){return this.fb.group({name:[t],percentage:[e,[y.required,y.min(0)]]})}onCriterionSelect(t,e){if(t.selected=!t.selected,t.selected)this.selectedCriteria.push(this.createCriterion(t.name));else{let r=this.selectedCriteria.controls.findIndex(i=>i.get("name")?.value===t.name);r!==-1&&this.selectedCriteria.removeAt(r)}}removeCriterion(t){let e=this.selectedCriteria.at(t).get("name")?.value,r=this.allCriteria.find(i=>i.name===e);r&&(r.selected=!1),this.selectedCriteria.removeAt(t)}addOption(t){this.getOptions(t).push(this.createOption("New",0))}removeOption(t,e){this.getOptions(t).removeAt(e)}calculateTotal(t){return t.get("options").controls.reduce((r,i)=>r+(i.get("percentage")?.value||0),0)}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["app-select-criteria"]],decls:18,vars:1,consts:[[1,"flex-grow","p-6","container-survey"],[1,"p-6",3,"formGroup"],[1,"text-xl","font-bold","mb-2"],[1,"text-gray-600","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8"],[1,"text-lg","font-semibold","mb-4"],[1,"space-y-2"],[1,"p-3","border","rounded-md","cursor-pointer","flex","items-center"],["formArrayName","selectedCriteria"],[1,"bg-gray-100","p-4","rounded-md","mb-4",3,"formGroupName"],[1,"p-3","border","rounded-md","cursor-pointer","flex","items-center",3,"click"],["type","checkbox",1,"mr-3",3,"checked"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center"],[1,"mr-2"],[1,"font-bold"],[1,"text-red-500",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"h-5","w-5"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd","fill-rule","evenodd"],["formArrayName","options"],[1,"flex","items-center","space-x-2","mb-2",3,"formGroupName"],[1,"flex","justify-end","items-center","mt-2"],[1,"font-bold","text-gray-700","mr-2"],[3,"ngClass"],[1,"mt-2","text-blue-500","font-semibold",3,"click"],["type","text","formControlName","name",1,"block","w-2/3","border","border-gray-400","rounded","px-2","py-1","bg-gray-50"],["type","number","formControlName","percentage",1,"w-1/4","border","border-gray-400","rounded","px-2","py-1","text-right"],["d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd","fill-rule","evenodd"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),c(3,"Select Criteria for Distribution"),o(),n(4,"p",3),c(5," Choose the criteria that will be used for score distribution. You can apply a High (H) or Low (L) distribution mode to each selected criterion. "),o(),n(6,"div",4)(7,"div")(8,"h2",5),c(9,"SELECTED CRITERIA"),o(),n(10,"ul",6),v(11,P,4,2,"li",7,_),o()(),n(13,"div",8)(14,"h2",5),c(15,"SELECTED CRITERIA"),o(),v(16,U,20,9,"div",9,_),o()()()()),e&2&&(l(),p("formGroup",r.form),l(10),g(r.allCriteria),l(5),g(r.selectedCriteria.controls))},dependencies:[R,I,O,G,k,$,D,V,L,B,N],styles:[".container-survey[_ngcontent-%COMP%]{min-width:500px}"]})};export{H as SelectCriteriaComponent};
